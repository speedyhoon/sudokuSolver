package main

import (
	"fmt"
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestPuzzle_Solve(t *testing.T) {
	tests := []struct {
		input     [mx]string
		want      string
		remaining int
	}{
		{
			input: [mx]string{
				" 654     ",
				" 3   5 76",
				"       2 ",
				"7  8   61",
				"     62  ",
				" 1    4  ",
				" 7   4 53",
				"      1  ",
				"8   9    ",
			},
			remaining: 0,
			want: `___________________
[2 6 5 4 7 8 3 1 9]
[4 3 1 9 2 5 8 7 6]
[9 8 7 6 1 3 5 2 4]
[7 4 3 8 5 2 9 6 1]
[5 9 8 1 4 6 2 3 7]
[6 1 2 7 3 9 4 8 5]
[1 7 9 2 8 4 6 5 3]
[3 2 4 5 6 7 1 9 8]
[8 5 6 3 9 1 7 4 2]
___________________
unsolved cell quantity: 0
`,
		},
		{
			input: [mx]string{
				" 5     1 ",
				"3 2   9 7",
				" 6 9 7 5 ",
				"  86 17  ",
				"    3    ",
				"  58 94  ",
				" 7 5 3 9 ",
				"5 4   3 1",
				" 1     2 ",
			},
			remaining: 0,
			want: `___________________
[7 5 9 3 4 2 6 1 8]
[3 8 2 1 5 6 9 4 7]
[4 6 1 9 8 7 2 5 3]
[9 4 8 6 2 1 7 3 5]
[6 2 7 4 3 5 1 8 9]
[1 3 5 8 7 9 4 6 2]
[2 7 6 5 1 3 8 9 4]
[5 9 4 2 6 8 3 7 1]
[8 1 3 7 9 4 5 2 6]
___________________
unsolved cell quantity: 0
`,
		},
		{
			input: [mx]string{
				"   5 9  6",
				" 1       ",
				"54 8   9 ",
				"89 4   6 ",
				"    2 3  ",
				"  7      ",
				"  67     ",
				"  1    5 ",
				"75  4 9 2",
			},
			remaining: 0,
			want: `___________________
[3 7 8 5 1 9 4 2 6]
[6 1 9 2 3 4 7 8 5]
[5 4 2 8 6 7 1 9 3]
[8 9 5 4 7 3 2 6 1]
[1 6 4 9 2 5 3 7 8]
[2 3 7 1 8 6 5 4 9]
[9 2 6 7 5 1 8 3 4]
[4 8 1 3 9 2 6 5 7]
[7 5 3 6 4 8 9 1 2]
___________________
unsolved cell quantity: 0
`,
		},
		{
			input: [mx]string{
				"7  5    1",
				"   19  4 ",
				"      67 ",
				" 9   4   ",
				" 3      7",
				"   2  58 ",
				"  8      ",
				" 52 7   9",
				"  38   6 ",
			},
			remaining: 47,
			want: `___________________
[7 . 4 5 . . . . 1]
[. . . 1 9 7 . 4 .]
[. . 9 . . . 6 7 .]
[. 9 . 7 . 4 . . .]
[. 3 . 6 . . . . 7]
[. . 7 2 . 9 5 8 .]
[. . 8 9 . . . 5 .]
[. 5 2 . 7 . 8 . 9]
[9 . 3 8 . . . 6 .]
___________________
unsolved cell quantity: 47
`,
		},
		{
			input: [mx]string{
				"4 67   85",
				" 8    9  ",
				"    5 1  ",
				"3  9     ",
				"        1",
				" 4  3  56",
				" 6  9  43",
				"      8  ",
				"  7  2   ",
			},
			want: `___________________
[4 9 6 7 1 3 2 8 5]
[1 8 5 6 2 4 9 3 7]
[7 2 3 8 5 9 1 6 4]
[3 5 1 9 7 6 4 2 8]
[6 7 2 5 4 8 3 9 1]
[8 4 9 2 3 1 7 5 6]
[2 6 8 1 9 7 5 4 3]
[9 1 4 3 6 5 8 7 2]
[5 3 7 4 8 2 6 1 9]
___________________
unsolved cell quantity: 0
`,
		},
		/*{

									input: [mx]string{
										"  1     8",
										" 2  9 5 6",
										"9  4     ",
										"  7  1   ",
										"       3 ",
										" 6  4 2 9",
										" 3     4 ",
										"    5  8 ",
										"  67  3 5",
									},
									want: `___________________
[6 7 1 5 2 3 4 9 8]
[3 2 4 1 9 8 5 7 6]
[9 5 8 4 7 6 1 2 3]
[5 9 7 2 3 1 8 6 4]
[4 8 2 9 6 5 7 3 1]
[1 6 3 8 4 7 2 5 9]
[8 3 5 6 1 2 9 4 7]
[7 1 9 3 5 4 6 8 2]
[2 4 6 7 8 9 3 1 5]
___________________
unsolved cell quantity: 0
`,
				},*/
		{
			input: [mx]string{
				" 4 8    5",
				" 9     3 ",
				"3 8  7  2",
				" 3    9  ",
				"    6   7",
				"1 59   2 ",
				"     95  ",
				"  4      ",
				"8 25   1 ",
			},
			want: `___________________
[2 4 1 8 9 3 7 6 5]
[5 9 7 6 1 2 4 3 8]
[3 6 8 4 5 7 1 9 2]
[7 3 6 2 8 5 9 4 1]
[4 2 9 3 6 1 8 5 7]
[1 8 5 9 7 4 6 2 3]
[6 1 3 7 2 9 5 8 4]
[9 5 4 1 3 8 2 7 6]
[8 7 2 5 4 6 3 1 9]
___________________
unsolved cell quantity: 0
`,
		},
		{

			input: [mx]string{
				"2        ",
				"6      8 ",
				"  1 8  34",
				"    1 7  ",
				"1 5 6 34 ",
				" 634  9  ",
				"7     1  ",
				"     8 5 ",
				"   5 6 7 ",
			},
			want: `___________________
[2 8 4 6 3 1 5 9 7]
[6 3 7 9 4 5 2 8 1]
[5 9 1 7 8 2 6 3 4]
[9 4 2 8 1 3 7 6 5]
[1 7 5 2 6 9 3 4 8]
[8 6 3 4 5 7 9 1 2]
[7 5 8 3 9 4 1 2 6]
[3 2 6 1 7 8 4 5 9]
[4 1 9 5 2 6 8 7 3]
___________________
unsolved cell quantity: 0
`,
		},
		{

			input: [mx]string{
				"  2 8 1 5",
				"        8",
				"587   3  ",
				"    3  9 ",
				"  61  23 ",
				" 9    7  ",
				" 6   9   ",
				"   7 6  3",
				" 482   6 ",
			},
			want: `___________________
[6 3 2 9 8 4 1 7 5]
[4 1 9 3 7 5 6 2 8]
[5 8 7 6 2 1 3 4 9]
[2 7 1 4 3 8 5 9 6]
[8 5 6 1 9 7 2 3 4]
[3 9 4 5 6 2 7 8 1]
[7 6 3 8 1 9 4 5 2]
[9 2 5 7 4 6 8 1 3]
[1 4 8 2 5 3 9 6 7]
___________________
unsolved cell quantity: 0
`,
		},
		{

			input: [mx]string{
				"4  15   6",
				" 1  4    ",
				"  52     ",
				" 6   32  ",
				"      4  ",
				"351    9 ",
				"   32  14",
				" 29 1   5",
				"   9    8",
			},
			remaining: 25,
			want: `___________________
[4 3 2 1 5 9 . . 6]
[9 1 . . 4 . 5 3 2]
[. . 5 2 3 . 1 4 9]
[. 6 4 . 9 3 2 . 1]
[2 9 . . . 1 4 . 3]
[3 5 1 4 . 2 . 9 7]
[5 . . 3 2 . 9 1 4]
[. 2 9 . 1 4 3 . 5]
[1 4 3 9 . 5 . 2 8]
___________________
unsolved cell quantity: 25
`,
		},
	}
	for i, tt := range tests {
		t.Run(fmt.Sprintf("test_%d", i), func(t *testing.T) {
			p := Load(
				tt.input[0], tt.input[1], tt.input[2],
				tt.input[3], tt.input[4], tt.input[5],
				tt.input[6], tt.input[7], tt.input[8],
			)
			p.Solve()
			assert.Equal(t, tt.remaining, p.UnsolvedCells())
			assert.Equal(t, tt.want, p.Printer())
		})
	}
}
